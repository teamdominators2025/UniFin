<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DMCIS | Nodal Portal</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/exif-js"></script>
</head>
<body>
    <div class="container">
        <button id="menu-toggle" class="menu-btn" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
        </button>
        <nav id="sidebar" class="sidebar">
            <div class="logo">DMCIS</div>
            <ul>
                <li class="active" onclick="window.scrollTo({top: 0, behavior: 'smooth'}); setActive(this)">
                    <i class="fas fa-home"></i> Home
                </li>
                <li onclick="scrollToSection('source-request')"><i class="fas fa-file-import"></i> Source Request</li>
                <li onclick="scrollToSection('performance-report')"><i class="fas fa-chart-line"></i> Performance Report</li>
                <li onclick="scrollToSection('my-profile')"><i class="fas fa-user-circle"></i> My Profile</li>
            </ul>
        </nav>


        <main id="main-content" class="main-content">
            <header class="nodal-command-header">
                <div class="header-inner">
                    
                    <h1 class="main-interface-title">NODAL OFFICER INTERFACE</h1>

                    <div class="boots-wrapper">
                        <div class="decorative-line"></div>
                        <span class="boots-text">BOOTS ON THE GROUND</span>
                        <div class="decorative-line"></div>
                    </div>

                    <div class="header-profile-tag" onclick="scrollToSection('my-profile')">
                        <div class="tag-details">
                            <span class="tag-rank" id="top-officer-name">PRIMARY NODAL OFFICER</span>
                            <span class="tag-id" id="top-officer-id">ID: ND-2026-DEL</span>
                        </div>
                        <div class="tag-avatar">
                            <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Officer">
                            <span class="status-dot"></span>
                        </div>
                    </div>
                </div>
            </header>
            <section class="stats-grid">
                <div class="stat-card glass skeleton" id="kpi-alerts">
                    <div class="stat-icon alert-bg"><i class="fas fa-exclamation-triangle"></i></div>
                    <div class="stat-info">
                        <h3 class="stat-value">--</h3>
                        <p class="stat-label">Active Alerts</p>
                    </div>
                </div>
                <div class="stat-card glass skeleton" id="kpi-water">
                    <div class="stat-icon water-bg"><i class="fas fa-tint"></i></div>
                    <div class="stat-info">
                        <h3 class="stat-value">--</h3>
                        <p class="stat-label">Avg Water Level</p>
                    </div>
                </div>
                <div class="stat-card glass skeleton" id="kpi-assets">
                    <div class="stat-icon asset-bg"><i class="fas fa-tools"></i></div>
                    <div class="stat-info">
                        <h3 class="stat-value">--</h3>
                        <p class="stat-label">Field Resources</p>
                    </div>
                </div>
            </section>
            <div class="search-container">
                <div class="search-box">
                    <i class="fas fa-search search-icon-blue"></i>
                    <input type="text" id="zone-search" placeholder="Search Nodal Zone (Minto, ITO, Dwarka)..." onkeyup="handleSearch(event)">
                    <button class="btn-search" onclick="triggerSearch()">Initialize Dashboard</button>
                </div>
            </div>
            <header class="dashboard-header">
                <div class="header-flex">
                    <h1 id="display-zone-name" class="styled-zone-name">System Readiness: Standby</h1>
                    <div class="status-pill-live">
                        <i class="fas fa-broadcast-tower live-icon-pulse"></i> 
                        <span>SYSTEM LIVE | DATA SYNCED</span>
                    </div>
                </div>
            </header>

            <section class="card border-blue">
                <h2 class="title-blue"><i class="fas fa-project-diagram"></i> Regional Connectivity Map</h2>
                <div id="map-area" class="map-container-final" style="height: 500px;">
                    <div id="leaflet-map" style="height: 100%; width: 100%;"></div>
                </div>
                <div id="suggestion-container"></div>
            </section>
            <section id="utility-control" class="card border-red-emergency" style="display: block;">
                <div class="emergency-header">
                    <div class="emergency-title">
                        <i class="fas fa-exclamation-triangle pulse-icon-red"></i>
                        <div>
                            <h2 class="text-red">CRITICAL WATER LEVEL DETECTED</h2>
                            <small class="text-muted">Location: Minto Road | Depth: 2.4 FT</small>
                        </div>
                    </div>
                    <div class="risk-badge">HIGH RISK OF ELECTROCUTION</div>
                </div>

                <div class="utility-grid">
                    <div class="utility-status">
                        <span class="label">LOCAL GRID STATUS:</span>
                        <span class="status-live-green" id="power-status-text">‚óè POWER ACTIVE</span>
                    </div>
                    
                    <div class="switch-container">
                        <p class="warning-text">Manual override required to isolate power from flooded streetlights and transformers.</p>
                        <button class="btn-kill-switch" id="kill-switch-btn" onclick="triggerPowerCut()">
                            <i class="fas fa-power-off"></i> INITIATE EMERGENCY POWER CUT
                        </button>
                    </div>
                </div>
            </section>

            <div id="telemetry-grid" class="feature-grid"></div>

            <section class="proof-section card border-black">
                <div class="proof-header">
                    <h2><i class="fas fa-shield-check"></i> PROOF OF ACTION</h2>
                </div>
                <div class="upload-container">
                    <div class="upload-slot before-border">
                        <i class="fas fa-history slot-icon"></i>
                        <label>PRE-INTERVENTION</label>
                        <input type="file" capture="camera">
                    </div>
                    <div class="upload-slot after-border">
                        <i class="fas fa-check-double slot-icon"></i>
                        <label>POST-INTERVENTION</label>
                        <input type="file" capture="camera">
                    </div>
                </div>
                <div id="upload-status" class="verification-text"></div>
                <button class="btn btn-blue" onclick="submitProof()">SYNC TO CENTRAL COMMAND</button>
            </section>
            <div class="feature-grid">
                <section id="source-request" class="card border-orange-premium">
                    <div class="resource-header-premium">
                        <h2 class="title-orange"><i class="fas fa-mitten"></i> Emergency Resource Command</h2>
                        <div class="status-badge-live">üì° LIVE INVENTORY</div>
                    </div>
                    
                    <div class="resource-grid">
                        <div class="resource-tile-premium" id="res-pump-1">
                            <div class="tile-icon-bg icon-blue">
                                <i class="fas fa-faucet-drip"></i>
                            </div>
                            <div class="res-info-premium">
                                <span class="res-category">Heavy Machinery</span>
                                <strong>Diesel Pump (150 HP)</strong>
                                <span class="status-glow-green" id="status-pump-1">‚óè Available: 04 Units</span>
                            </div>
                            <div class="dispatch-progress" id="progress-pump-1" style="display:none; margin-top: 10px;">
                                <div class="progress-bar-fill-premium"></div>
                                <small style="color: #3b82f6; font-size: 10px; font-weight: bold;">MOBILIZING ASSET...</small>
                            </div>
                            <button class="btn-command-blue" onclick="executeCommand('pump-1', 'Diesel Pump')">
                                <i class="fas fa-paper-plane"></i> DISPATCH NOW
                            </button>
                        </div>

                        <div class="resource-tile-premium" id="res-qrt-1">
                            <div class="tile-icon-bg icon-purple">
                                <i class="fas fa-users-gear"></i>
                            </div>
                            <div class="res-info-premium">
                                <span class="res-category">Specialized Squad</span>
                                <strong>Quick Response Team</strong>
                                <span class="status-glow-orange" id="status-qrt-1">‚óè Available: 02 Units</span>
                            </div>
                            
                            <div class="dispatch-progress" id="progress-qrt-1" style="display:none; margin-top: 10px;">
                                <div class="progress-bar-fill-purple"></div>
                                <small style="color: #a855f7; font-size: 10px; font-weight: bold;">PREPARING SQUAD FOR DEPLOYMENT...</small>
                            </div>

                            <button class="btn-command-purple" onclick="executeCommand('qrt-1', 'QRT Squad')">
                                <i class="fas fa-bolt"></i> DEPLOY SQUAD
                            </button>
                        </div>

                        <div class="resource-tile-premium" id="res-sand-1">
                            <div class="tile-icon-bg icon-red">
                                <i class="fas fa-truck-ramp-box"></i>
                            </div>
                            <div class="res-info-premium">
                                <span class="res-category">Logistics Support</span>
                                <strong>Sandbag Truck (500)</strong>
                                <span class="status-glow-red" id="status-sand-1">‚óè All On Mission</span>
                            </div>
                            <button class="btn-command-locked" disabled>
                                <i class="fas fa-clock"></i> ON WAITLIST
                            </button>
                        </div>
                    </div>

                    <div class="custom-request-box-premium">
                        <h4><i class="fas fa-comment-dots"></i> Site-Specific Requirements</h4>
                        <div class="input-wrapper-premium">
                            <textarea placeholder="Ex: Requesting additional sewer divers for Minto Road site..."></textarea>
                            <button class="btn-priority-gold" onclick="alert('Priority signal sent to HQ')">
                                SUBMIT HIGH-PRIORITY COMMAND ‚ö°
                            </button>
                        </div>
                    </div>
                </section>
                <section id="performance-report" class="card border-blue-premium">
                    <div class="report-header-premium">
                        <h2 class="title-indigo"><i class="fas fa-chart-line-up"></i> Annual Performance Scorecard</h2>
                        <div class="season-badge-gold">üèÜ MONSOON SEASON 2026</div>
                    </div>

                    <div class="score-summary-grid">
                        <div class="score-card-grad card-emerald">
                            <span class="score-label-white">Overall Rating</span>
                            <div class="stars-gold">
                                <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star-half-alt"></i>
                            </div>
                            <div class="numeric-val">4.2 <small>/ 5</small></div>
                            <p class="card-footer-text">‚≠ê Based on 124 Citizens</p>
                        </div>

                        <div class="score-card-grad card-indigo">
                            <span class="score-label-white">Audit Grade</span>
                            <div class="audit-grade-display">A+</div>
                            <p class="card-footer-text">‚úÖ Quality Verified</p>
                        </div>

                        <div class="score-card-grad card-amber">
                            <span class="score-label-white">Avg. Response Time</span>
                            <div class="response-time-display">42 <small>min</small></div>
                            <p class="card-footer-text">‚ö° Top 5% Speed</p>
                        </div>
                    </div>

                    <div class="performance-details-box">
                        <div class="audit-status-bar">
                            <span class="pulse-icon-blue"></span>
                            <span class="live-text">SYNCING REAL-TIME AUDIT LOGS...</span>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="audit-table-styled">
                                <thead>
                                    <tr>
                                        <th>LOCATION</th>
                                        <th>DATE</th>
                                        <th>CITIZEN FEEDBACK</th>
                                        <th>AUDIT RESULT</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="text-indigo"><strong>Minto Road Bridge</strong></td>
                                        <td class="text-muted">15 July 2026</td>
                                        <td class="text-gold">Excellent ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</td>
                                        <td><span class="badge-success">PASSED</span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-indigo"><strong>ITO Junction</strong></td>
                                        <td class="text-muted">Audit going on</td>
                                        <td class="text-amber">---</td>
                                        <td><span class="badge-warning">REVIEWING</span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-indigo"><strong>Ashram Chowk</strong></td>
                                        <td class="text-muted">10 July 2026</td>
                                        <td class="text-gold">Excellent ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</td>
                                        <td><span class="badge-success">PASSED</span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-indigo"><strong>Karol Bagh</strong></td>
                                        <td class="text-muted">Audit going on</td>
                                        <td class="text-amber">---</td>
                                        <td><span class="badge-warning">REVIEWING</span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-indigo"><strong>Lajpat Nagar</strong></td>
                                        <td class="text-muted">23 July 2026</td>
                                        <td class="text-gold">Okay!But can improve ‚≠ê‚≠ê</td>
                                        <td><span class="badge-success">PASSED</span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-indigo"><strong>Dwarka Sector 10</strong></td>
                                        <td class="text-muted">20 July 2026</td>
                                        <td class="text-gold">Good ‚≠ê‚≠ê‚≠ê</td>
                                        <td><span class="badge-success">PASSED</span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-indigo">Hauz Khas<strong></strong></td>
                                        <td class="text-muted">Audit going on</td>
                                        <td class="text-amber">---</td>
                                        <td><span class="badge-warning">REVIEWING</span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-indigo"><strong>Rohini Sector 7</strong></td>
                                        <td class="text-muted">22 July 2026</td>
                                        <td class="text-gold">Requires Improvement ‚≠ê</td>
                                        <td><span class="badge-success">PASSED</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </div>

            <section id="my-profile" class="card border-indigo-premium">
                <div class="profile-header-premium">
                    <h2 class="title-indigo"><i class="fas fa-user-circle"></i> Nodal Officer Profile</h2>
                    <span class="edit-badge">üîí SECURE ACCESS</span>
                </div>

                <div class="profile-container-grid">
                    <div class="profile-main-inputs">
                        <div class="input-row">
                            <div class="input-field">
                                <label><i class="fas fa-id-card"></i> Full Name</label>
                                <input type="text" id="input-name" placeholder="Enter Name" oninput="syncProfile()">
                            </div>
                            <div class="input-field">
                                <label><i class="fas fa-fingerprint"></i> Officer ID</label>
                                <input type="text" id="input-id" placeholder="Enter ID" oninput="syncProfile()">
                            </div>
                        </div>

                        <div class="input-field">
                            <label><i class="fas fa-map-marker-alt"></i> Assigned Jurisdiction</label>
                            <select id="jurisdiction">
                                <option>Minto Bridge</option>
                                <option>ITO Junction</option>
                                <option>Ashram Chowk</option>
                                <option>Lajpat Nagar</option>
                                <option>Munirka</option>
                                <option>Dwarka Sector 10</option>
                                <option>Rohini Sector 7</option>
                                <option>Pitampura</option>
                                <option>Saket</option>
                                <option>Hauz Khas</option>
                                <option>Nehru Place</option>
                                <option>Okhla Phase 3</option>
                                <option>Karol Bagh</option>
                                <option>Chandni Chowk</option>
                                <option>Connaught Place</option>
                                <option>RK Puram</option>
                                <option>Vasant Kunj</option>
                                <option>Janakpuri</option>
                                <option>Vikaspuri</option>
                                <option>Nizamuddin East</option>
                                <option>Mayur Vihar Ph 1</option>
                                <option>Laxmi Nagar</option>
                                <option>Preet Vihar</option>
                                <option>Shahdara</option>
                                <option>Dilshad Garden</option>
                                <option>Civil Lines</option>
                                <option>Model Town</option>
                                <option>Punjabi Bagh</option>
                                <option>Rajouri Garden</option>
                                <option>Paschim Vihar</option>
                            </select>
                        </div>

                        <div class="input-row">
                            <div class="input-field">
                                <label><i class="fas fa-phone"></i> Phone Number</label>
                                <input type="tel" id="input-phone" placeholder="+91 XXXX-XXXXXX">
                            </div>
                            <div class="input-field">
                                <label><i class="fas fa-briefcase"></i> Designation</label>
                                <input type="text" id="input-designation" placeholder="Enter your designation">
                            </div>
                        </div>
                    </div>

                    <div class="profile-action-sidebar">
                        <div class="action-card-inner">
                            <i class="fas fa-cloud-upload-alt action-icon"></i>
                            <p>Ensure all field data is accurate before committing changes to the central server.</p>
                            <button class="btn-update-premium" onclick="alert('Profile Updated Successfully!')">
                                UPDATE SETTINGS
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="script.js"></script>
</body>
</html>